# Preprocessing functions for collaborative filtering